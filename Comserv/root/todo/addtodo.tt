[% PageVersion = 'addtodo.tt,v 0.04 2024/11/23 shanta Exp shanta ' %]
[% IF debug_mode == 1 %]
    Version: [% PageVersion %]
[% END %]



<h1>Add a New To-do Item</h1>

<form action="/todo/create" method="post">
    <div>
        <label for="sitename">Site Name:</label>
        <input type="text" id="sitename" name="sitename" value="[% SiteName OR 'Site Name' %]" readonly>
    </div>
    <div>
        <label for="start_date">Start Date:</label>
        <input type="date" id="start_date" name="start_date" value="[% start_date OR '' %]">
    </div>
    <div>
        <label for="project_id">Select Project:</label>
          [% INCLUDE "todo/project_list.tt" projects=projects selected_project_id=current_project.id %]<br>
    </div>

    <div>
        <label for="manual_project_id">Manual Project ID:</label>
        <input type="text" id="manual_project_id" name="manual_project_id" value="[% project_id OR '' %]" placeholder="Only if project not in list">
    </div>
    <div>
        <label for="due_date">Due Date:</label>
        <input type="date" id="due_date" name="due_date" value="[% todo.due_date OR '' %]">
    </div>
    <div>
        <label for="time_of_day">Time of Day (optional):</label>
        <div class="time-input-container">
            <select id="time_preset" class="time-preset" onchange="setTimeFromPreset()" style="margin-bottom: 5px; padding: 5px; width: 100%;">
                <option value="">-- Select Common Time --</option>
                <option value="08:00">8:00 AM</option>
                <option value="09:00">9:00 AM</option>
                <option value="10:00">10:00 AM</option>
                <option value="11:00">11:00 AM</option>
                <option value="12:00">12:00 PM</option>
                <option value="13:00">1:00 PM</option>
                <option value="14:00">2:00 PM</option>
                <option value="15:00">3:00 PM</option>
                <option value="16:00">4:00 PM</option>
                <option value="17:00">5:00 PM</option>
                <option value="18:00">6:00 PM</option>
                <option value="19:00">7:00 PM</option>
                <option value="20:00">8:00 PM</option>
            </select>
            <input type="time" id="time_of_day" name="time_of_day" value="[% todo.time_of_day OR '' %]" placeholder="HH:MM" style="width: 100%; padding: 5px;">
        </div>
        <small style="color: #666; font-size: 0.9em;">Select from common times or enter manually for day view organization</small>
    </div>

    <script>
    function setTimeFromPreset() {
        var preset = document.getElementById('time_preset');
        var manual = document.getElementById('time_of_day');
        if (preset.value) {
            manual.value = preset.value;
        }
    }
    </script>
    <div>
        <label for="subject">Subject:</label>
        <input type="text" id="subject" name="subject" value="[% todo.subject OR '' %]">
    </div>
    <div>
        <label for="description">Description:</label>
        <textarea id="description" name="description">[% todo.description OR '' %]</textarea>
    </div>
    <div>
        <label for="estimated_man_hours">Estimated Man Hours:</label>
        <select id="estimated_man_hours" name="estimated_man_hours">
        [% FOREACH hour IN [1..24] %]
        <option value="[% hour %]" [% IF hour == todo.estimated_man_hours %]selected[% END %]>[% hour %]</option>
        [% END %]
        </select>
    </div>
    <div>
        <label for="accumulative_time">Accumulative Time:</label>
        <input type="number" id="accumulative_time" name="accumulative_time" value="[% todo.accumulative_time OR '' %]">
    </div>
    <div>
        <label for="status">Status:</label>
        <select id="status" name="status" class="form-select">
            <option value="1" [% IF todo.status == 'NEW' %]selected[% END %]>NEW</option>
            <option value="2" [% IF todo.status == 'IN PROGRESS' %]selected[% END %]>IN PROGRESS</option>
            <option value="3" [% IF todo.status == 'DONE' %]selected[% END %]>DONE</option>
        </select>
    </div>
    <div>
        <label for="priority">Priority:</label>
        <select id="priority" name="priority" class="form-select">
        [% FOREACH priority IN [1..10] %]
        <option value="[% priority %]" [% IF priority == todo.priority %]selected[% END %]>[% priority %]</option>
        [% END %]
        </select>
    </div>
    <div>
        <label for="share">Share:</label>
        <select id="share" name="share" class="form-select">
            <option value="0" [% IF todo.share == 'public' %]selected[% END %]>Public</option>
            <option value="1" [% IF todo.share == 'private' %]selected[% END %]>Private</option>
        </select>
    </div>
    <div>
        <label for="last_mod_by">Last Modified By:</label>
        <input type="text" id="last_mod_by" name="last_mod_by" value="[% todo.last_mod_by OR '' %]">
    </div>
    <div>
        <label for="last_mod_date">Last Modified Date:</label>
        <input type="date" id="last_mod_date" name="last_mod_date" value="[% todo.last_mod_date OR '' %]">
    </div>
    <div>
        <label for="user_id">User ID:</label>
        <select id="user_id" name="user_id" class="form-select">
        [% FOREACH user IN users %]
        <option value="[% user.id %]" [% IF user.id == user_id %]selected[% END %]>[% user.username %]</option>
        [% END %]
        </select>
    </div>
    <div>
        <input type="submit" value="Add Todo" class="btn btn-primary">
    </div>
</form>
