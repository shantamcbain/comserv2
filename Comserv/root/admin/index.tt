[% META title = 'Admin Dashboard' %]
[% PageVersion = 'admin/index.tt,v 0.03 2025/01/15 shanta Exp shanta ' %]

<!-- Include admin-specific CSS -->
<!--<link rel="stylesheet" type="text/css" href="[% c.uri_for('/static/css/themes/admin.css') %]">
-->

[% IF is_admin %]
<h1>Admin Dashboard</h1>

[% IF debug_mode == 1 %]
    [% PageVersion %]
    <div class="debug">
        <p>Admin access confirmed: is_admin=[% is_admin %], user=[% c.session.username || 'unknown' %]</p>
    </div>
[% END %]

<div class="admin-menu">
  <h2>Admin Menu</h2>

  <div class="admin-section">
    <h3>Database Management</h3>
    <ul>
      <li><a href="[% c.uri_for('/admin/database_mode') %]"><i class="icon-database"></i>Database Backend Selection</a></li>
      <li><a href="[% c.uri_for('/admin/schema_manager') %]">Schema Manager</a></li>
      <li><a href="[% c.uri_for('/admin/compare_schema') %]">Compare Schema</a></li>
      <li><a href="[% c.uri_for('/admin/migrate_schema') %]">Migrate Schema</a></li>
    </ul>
  </div>

  <div class="admin-section">
    <h3>System Management</h3>
    <ul>
      <li><a href="[% c.uri_for('/admin/theme') %]">Theme Management</a></li>
      <li><a href="[% c.uri_for('/admin/logging') %]"><i class="icon-log"></i>Logging Administration</a></li>
      <li><a href="[% c.uri_for('/admin/view_log') %]">View Application Log</a></li>
      <li><a href="[% c.uri_for('/admin/network_diagnostics') %]">Network Diagnostics</a></li>
      <li><a href="[% c.uri_for('/admin/access_control_help') %]">Access Control Help</a></li>
      [% IF has_csc_access %]
      <li><a href="[% c.uri_for('/admin/backup') %]">Backup Management</a> <span class="csc-only">(CSC Only)</span></li>
      [% END %]
    </ul>
  </div>

  <div class="admin-section">
    <h3>Git Operations</h3>
    <ul>
      <li><a href="[% c.uri_for('/admin/git_pull') %]">Pull from Git Repository</a></li>
    </ul>
  </div>

  <div class="admin-section">
    <h3>Production Deployment (CSC Admin + Install Branch Only)</h3>
    <ul>
      <li><a href="[% c.uri_for('/admin/software_upgrade') %]" class="upgrade-link"><strong>Software Upgrade Manager</strong></a> - Complete step-by-step upgrade process</li>
      <li><a href="[% c.uri_for('/admin/start_dev_server') %]">Start Development Server for Testing</a></li>
      <li><a href="[% c.uri_for('/admin/restart_starman') %]">Restart Production Server (Starman)</a></li>
      [% IF c.session.dev_server %]
      <li><a href="[% c.session.dev_server.url %]" target="_blank" class="dev-server-link">Open Development Server</a> | <a href="[% c.uri_for('/admin/stop_dev_server') %]">Stop Dev Server</a></li>
      [% END %]
    </ul>
  </div>

  <div class="admin-section">
    <h3>Infrastructure</h3>
    <ul>
      <li><a href="[% c.uri_for('/proxmox') %]">Proxmox VM Management</a></li>
      <li><a href="[% c.uri_for('/proxmox_servers') %]">Proxmox Server Management</a></li>
    </ul>
  </div>
</div>

[% ELSE %]
<div class="access-denied">
    <h1>Access Denied</h1>
    <p>You need administrator privileges to access this area.</p>
    <p><a href="[% c.uri_for('/user/login') %]">Please log in</a> with an administrator account.</p>
</div>
[% END %]

<!-- CSS now handled by admin.css theme file -->
