[% PageVersion = 'Comserv/root/Documentation/general/menu_system.tt,v 1.1 2025/01/27 shanta Exp shanta ' %]
[% IF c.session.debug_mode == 1 %]
    [% PageVersion %]
[% END %]

[% META title = 'Navigation & Menu System Documentation' %]

<div class="apiary-container">
    <header class="apiary-header">
        <h1><i class="fas fa-bars"></i> Navigation & Menu System Documentation</h1>
        <div class="apiary-context">
            <span class="context-item"><strong>Last Updated:</strong> 2025-01-27</span>
            <span class="context-item"><strong>Version:</strong> 1.1</span>
            <span class="context-item"><strong>Status:</strong> Universal Add Link Access COMPLETED</span>
        </div>
    </header>
    
    <section id="overview">
        <h2>System Overview</h2>
        <p>The Comserv Navigation System provides dynamic menu management capabilities across the entire application. It supports multiple menu types, site-specific permissions, and user-customizable navigation structures.</p>
    </section>

    <section id="current-status">
        <h2>Current Status</h2>
        <div class="status-highlight">
            <h3><i class="fas fa-check-circle"></i> UNIVERSAL ADD LINK ACCESS COMPLETED</h3>
            <p><strong>Major Achievement:</strong> All navigation menus now have "Add Menu Link" functionality with automatic category pre-selection. Users can add links directly from any menu context, making the navigation system truly universal and user-friendly.</p>

            <div class="benefits-list">
                <h4>Key Benefits:</h4>
                <ul>
                    <li><i class="fas fa-check"></i> <strong>Universal Access:</strong> Every navigation menu has "Add Link" button</li>
                    <li><i class="fas fa-check"></i> <strong>Context-Aware:</strong> Automatic category pre-selection based on source menu</li>
                    <li><i class="fas fa-check"></i> <strong>Consistent UI:</strong> All menus follow same pattern with private links + management</li>
                    <li><i class="fas fa-check"></i> <strong>Enhanced UX:</strong> No need to navigate to admin menu to add links</li>
                </ul>
            </div>
        </div>
    </section>

    <section id="architecture">
        <h2>Current Architecture</h2>
        
        <div class="architecture-section">
            <h3>Database Tables</h3>
            <div class="table-info">
                <h4><code>internal_links_tb</code></h4>
                <p>Stores all navigation links with categories, sites, and ordering</p>
                <div class="field-list">
                    <strong>Fields:</strong>
                    <ul>
                        <li><code>id</code> - Primary key</li>
                        <li><code>category</code> - Menu category classification</li>
                        <li><code>sitename</code> - Site-specific targeting</li>
                        <li><code>name</code> - Display name for the link</li>
                        <li><code>url</code> - Target URL</li>
                        <li><code>target</code> - Link target (_blank, _self, etc.)</li>
                        <li><code>view_name</code> - Associated view</li>
                        <li><code>page_code</code> - Page identifier</li>
                        <li><code>link_order</code> - Display ordering</li>
                        <li><code>status</code> - Active/inactive status</li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="architecture-section">
            <h3>Controller</h3>
            <div class="controller-info">
                <h4><code>Comserv::Controller::Navigation</code></h4>
                <p>Handles all navigation-related operations</p>
                <p><strong>Location:</strong> <code>/home/shanta/PycharmProjects/comserv2/Comserv/lib/Comserv/Controller/Navigation.pm</code></p>
            </div>
        </div>

        <div class="architecture-section">
            <h3>Templates</h3>
            <div class="template-list">
                <ul>
                    <li><strong>Add Link:</strong> <code>/home/shanta/PycharmProjects/comserv2/Comserv/root/Navigation/add_link.tt</code></li>
                    <li><strong>Edit Link:</strong> <code>/home/shanta/PycharmProjects/comserv2/Comserv/root/Navigation/edit_link.tt</code></li>
                    <li><strong>Manage Links:</strong> <code>/home/shanta/PycharmProjects/comserv2/Comserv/root/Navigation/manage_links.tt</code></li>
                    <li><strong>Private Links:</strong> <code>/home/shanta/PycharmProjects/comserv2/Comserv/root/Navigation/manage_private_links.tt</code></li>
                </ul>
            </div>
        </div>
    </section>

    <section id="completed-features">
        <h2>Completed Features</h2>
        
        <div class="feature-section">
            <h3><i class="fas fa-cog"></i> 1. Admin Menu Management</h3>
            <div class="status-badge completed">
                <i class="fas fa-check-circle"></i> 100% COMPLETE with Security
            </div>
            <div class="feature-details">
                <ul>
                    <li><strong>Add Links:</strong> Full form with category selection, site targeting, and validation</li>
                    <li><strong>Edit Links:</strong> Complete CRUD operations with permission checks</li>
                    <li><strong>Delete Links:</strong> Secure deletion with site ownership validation</li>
                    <li><strong>Manage Links:</strong> Filtered display based on user permissions</li>
                    <li><strong>Site Security:</strong> SiteName and CSC have full access, others restricted to own site</li>
                </ul>
            </div>
        </div>

        <div class="feature-section">
            <h3><i class="fas fa-user-lock"></i> 2. Private Links System</h3>
            <div class="status-badge completed">
                <i class="fas fa-check-circle"></i> 100% COMPLETE
            </div>
            <div class="feature-details">
                <ul>
                    <li><strong>Personal Links:</strong> User-specific navigation links</li>
                    <li><strong>Full CRUD:</strong> Add, edit, delete, and manage private links</li>
                    <li><strong>User Isolation:</strong> Each user sees only their own private links</li>
                </ul>
            </div>
        </div>
    </section>

    <section id="menu-categories">
        <h2>Menu Categories (Current System)</h2>
        
        <div class="categories-grid">
            <div class="category-item">
                <h4><i class="fas fa-cog"></i> Admin_links</h4>
                <p>Administrative functions dropdown</p>
            </div>
            <div class="category-item">
                <h4><i class="fas fa-home"></i> Main_links</h4>
                <p>Primary navigation menu</p>
            </div>
            <div class="category-item">
                <h4><i class="fas fa-users"></i> Member_links</h4>
                <p>Member-specific navigation</p>
            </div>
            <div class="category-item">
                <h4><i class="fas fa-server"></i> Hosted_link</h4>
                <p>Hosted services and applications</p>
            </div>
            <div class="category-item">
                <h4><i class="fas fa-sign-in-alt"></i> Login_links</h4>
                <p>Login dropdown options</p>
            </div>
            <div class="category-item">
                <h4><i class="fas fa-link"></i> Footer_links</h4>
                <p>Footer navigation links</p>
            </div>
            <div class="category-item">
                <h4><i class="fas fa-globe"></i> Global_links</h4>
                <p>Global navigation options</p>
            </div>
            <div class="category-item">
                <h4><i class="fas fa-question-circle"></i> HelpDesk_links</h4>
                <p>Help desk and support links</p>
            </div>
            <div class="category-item">
                <h4><i class="fas fa-laptop"></i> IT_links</h4>
                <p>IT resources and tools</p>
            </div>
            <div class="category-item">
                <h4><i class="fas fa-cloud-sun"></i> Weather_links</h4>
                <p>Weather-related functionality</p>
            </div>
        </div>
    </section>

    <section id="permissions">
        <h2>Site-Based Permissions</h2>
        
        <div class="permissions-info">
            <h3>Privilege Levels</h3>
            <div class="privilege-levels">
                <div class="privilege-item high">
                    <h4><i class="fas fa-crown"></i> SiteName & CSC</h4>
                    <p>Full access to all sites and links</p>
                </div>
                <div class="privilege-item standard">
                    <h4><i class="fas fa-user"></i> Other Sites</h4>
                    <p>Restricted to own site links only</p>
                </div>
                <div class="privilege-item security">
                    <h4><i class="fas fa-shield-alt"></i> Security</h4>
                    <p>Server-side validation prevents unauthorized access</p>
                </div>
            </div>
        </div>
    </section>

    <section id="quick-reference">
        <h2>Quick Reference</h2>
        
        <div class="quick-ref-sections">
            <div class="ref-section">
                <h3><i class="fas fa-plus-circle"></i> Add Link to Any Menu - Universal Access</h3>
                <div class="ref-details">
                    <p><strong>URL Pattern:</strong></p>
                    <code>/navigation/add_link?menu=&lt;menu_type&gt;</code>
                    
                    <p><strong>Parameters:</strong> admin, main, member, hosted, login, footer, global, helpdesk, it, weather</p>
                    
                    <div class="highlight-box">
                        <p><strong>All navigation menus now have "Add Menu Link" buttons with automatic category pre-selection</strong></p>
                    </div>
                </div>
            </div>

            <div class="ref-section">
                <h3><i class="fas fa-users-cog"></i> Site Permissions</h3>
                <ul>
                    <li><strong>SiteName & CSC:</strong> Full access to all sites</li>
                    <li><strong>Other Sites:</strong> Own site only</li>
                </ul>
            </div>

            <div class="ref-section">
                <h3><i class="fas fa-database"></i> Database Table</h3>
                <ul>
                    <li><strong>Table:</strong> <code>internal_links_tb</code></li>
                    <li><strong>Key Fields:</strong> <code>category</code>, <code>sitename</code>, <code>name</code>, <code>url</code>, <code>link_order</code></li>
                </ul>
            </div>

            <div class="ref-section">
                <h3><i class="fas fa-code"></i> Controller Methods</h3>
                <ul>
                    <li><strong>add_link:</strong> Add new navigation link</li>
                    <li><strong>edit_link:</strong> Modify existing link</li>
                    <li><strong>delete_link:</strong> Remove navigation link</li>
                    <li><strong>manage_links:</strong> Admin interface for link management</li>
                    <li><strong>manage_private_links:</strong> User private link management</li>
                </ul>
            </div>
        </div>
    </section>

    <footer class="documentation-footer">
        <hr>
        <p><em>This documentation is part of the Comserv system documentation suite.</em></p>
        <p><strong>Last Updated:</strong> 2025-01-27 | <strong>Version:</strong> 1.1</p>
    </footer>

</div>
