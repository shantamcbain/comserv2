[% PageVersion = 'Documentation/changelog/2025-07-15-cloudflare-sitename-domain-mappings.tt,v 0.01 2025/07/15 shanta Exp shanta ' %]
[% IF debug_mode == 1 %]
    [% PageVersion %]
[% END %]

<div class="documentation-page">
    <h1>Cloudflare SiteName Domain Mappings</h1>
    
    <div class="metadata">
        <p><strong>Date:</strong> 2025-07-15</p>
        <p><strong>Author:</strong> System Administrator</p>
        <p><strong>Type:</strong> Enhancement</p>
    </div>
    
    <div class="section">
        <h2>Description</h2>
        <p>
            Added functionality to display SiteName domain mappings in the Cloudflare DNS Management interface. 
            This enhancement allows users to see the mapping between site names and their associated domains, 
            making it easier to manage DNS records for specific sites.
        </p>
    </div>
    
    <div class="section">
        <h2>Changes</h2>
        <ol>
            <li>Added a new section to the Cloudflare DNS Management interface that displays SiteName domain mappings</li>
            <li>Updated the CloudflareAPI controller to fetch site names and their domains from the site and sitedomain tables</li>
            <li>Fixed issues with domain retrieval to ensure proper display of domains for each site</li>
            <li>Enhanced the template to display all domains associated with each site name in a card-based layout</li>
            <li>Added visual indicators for domains that are managed by Cloudflare</li>
            <li>Added direct links to manage DNS records for domains that are in Cloudflare</li>
        </ol>
    </div>
    
    <div class="section">
        <h2>Files Modified</h2>
        <ul>
            <li><code>/Comserv/lib/Comserv/Controller/CloudflareAPI.pm</code></li>
            <li><code>/Comserv/root/cloudflare/index.tt</code></li>
        </ul>
    </div>
    
    <div class="section">
        <h2>Files Created</h2>
        <ul>
            <li><code>/Comserv/root/Documentation/changelog/2025-07-15-cloudflare-sitename-domain-mappings.tt</code></li>
        </ul>
    </div>
    
    <div class="section">
        <h2>How to Use</h2>
        <ol>
            <li>Navigate to the Cloudflare DNS Management interface</li>
            <li>Scroll down to the "SiteName Domain Mappings" section</li>
            <li>View the list of site names and all their associated domains</li>
            <li>Click on the "Manage DNS" button to manage DNS records for a specific domain</li>
        </ol>
    </div>
    
    <div class="section">
        <h2>Technical Details</h2>
        <ul>
            <li>The SiteName domain mappings are fetched from the <code>Site</code> and <code>SiteDomain</code> tables in the database</li>
            <li>The mappings are displayed in a card-based grid layout, with each card representing a site</li>
            <li>All domains associated with a site are displayed in a list within the site's card</li>
            <li>Domains that are managed by Cloudflare are highlighted and include a "Cloudflare" badge</li>
            <li>Clicking on a Cloudflare-managed domain takes you to the DNS management page for that domain</li>
            <li>If a site has no associated domains, a message is displayed indicating that no domain is configured</li>
            <li>The layout is responsive and will adjust to different screen sizes</li>
        </ul>
    </div>
</div>

<style>
    .documentation-page {
        max-width: 1000px;
        margin: 0 auto;
        padding: 20px;
        font-family: Arial, sans-serif;
    }
    
    .metadata {
        background-color: #f8f9fa;
        padding: 15px;
        border-radius: 5px;
        margin-bottom: 20px;
    }
    
    .metadata p {
        margin: 5px 0;
    }
    
    .section {
        margin-bottom: 30px;
    }
    
    h1 {
        color: #333;
        border-bottom: 2px solid #007bff;
        padding-bottom: 10px;
    }
    
    h2 {
        color: #007bff;
        margin-top: 0;
    }
    
    code {
        background-color: #f8f9fa;
        padding: 2px 5px;
        border-radius: 3px;
        font-family: monospace;
        color: #d63384;
    }
    
    ul, ol {
        padding-left: 20px;
    }
    
    li {
        margin-bottom: 8px;
    }
</style>