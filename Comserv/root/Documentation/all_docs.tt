[% PageVersion = 'Comserv/root/Documentation/all_docs.tt,v 0.02 2025/01/20 shanta Exp shanta ' %]
[% IF c.session.debug_mode == 1 %]
    [% PageVersion %]
[% END %]

[% META title = 'All Documentation Files' %]

<!-- All Documentation Files Section -->
[% IF categories.general && categories.general.pages.size > 0 %]
    <div class="section">
        <div class="section-header collapsible-header" onclick="toggleSection('all-docs-section')">
            <h3><i class="fas fa-folder-open"></i>All Documentation Files <span class="toggle-icon"></span></h3>
        </div>
        <div id="all-docs-section" class="section-content collapsible-content" style="display: none;">
            <p>Complete list of all documentation files. <span class="admin-badge">Admin Only</span></p>
        
        <div class="feature-actions" style="margin-bottom: 20px;">
            <button class="btn btn-primary active" onclick="showFileType(event, 'all-docs')">
                <i class="fas fa-list"></i>All Files
            </button>
            <button class="btn btn-secondary" onclick="showFileType(event, 'template-docs')">
                <i class="fas fa-file-code"></i>Template Files
            </button>
            <button class="btn btn-secondary" onclick="showFileType(event, 'markdown-docs')">
                <i class="fas fa-file-alt"></i>Markdown Files
            </button>
            <button class="btn btn-secondary" onclick="showFileType(event, 'other-docs')">
                <i class="fas fa-file"></i>Other Files
            </button>
        </div>
        
        <!-- All Documents Tab -->
        <div class="admin-grid file-type-content" id="all-docs">
            [% sorted_pages = [] %]
            [% FOREACH page_name IN categories.general.pages %]
                [% IF structured_pages.$page_name %]
                    [% sorted_pages.push({ name => page_name, title => structured_pages.$page_name.title }) %]
                [% END %]
            [% END %]
            
            [% sorted_pages = sorted_pages.nsort('title') %]
            [% FOREACH page_info IN sorted_pages %]
                [% page_name = page_info.name %]
                [% page = structured_pages.$page_name %]
                <div class="admin-card">
                    <h4><i class="fas fa-file-alt"></i>[% page.title %]</h4>
                    <p>[% page.description || 'Documentation file.' %]</p>
                    <ul>
                        <li><a href="[% page.url %]">View Documentation</a></li>
                    </ul>
                </div>
            [% END %]
        </div>
        
        <!-- Template Documents Tab -->
        <div class="admin-grid file-type-content" id="template-docs" style="display: none;">
            [% template_pages = [] %]
            [% FOREACH page_name IN categories.general.pages %]
                [% IF structured_pages.$page_name && structured_pages.$page_name.file_type == 'template' %]
                    [% template_pages.push({ name => page_name, title => structured_pages.$page_name.title }) %]
                [% END %]
            [% END %]
            
            [% template_pages = template_pages.nsort('title') %]
            [% IF template_pages.size > 0 %]
                [% FOREACH page_info IN template_pages %]
                    [% page_name = page_info.name %]
                    [% page = structured_pages.$page_name %]
                    <div class="admin-card">
                        <h4><i class="fas fa-file-code"></i>[% page.title %]</h4>
                        <p>[% page.description || 'Template documentation file.' %]</p>
                        <span class="file-type-badge template">template</span>
                        <ul>
                            <li><a href="[% page.url %]">View Template</a></li>
                        </ul>
                    </div>
                [% END %]
            [% ELSE %]
                <div class="admin-card">
                    <h4><i class="fas fa-info-circle"></i>No Template Files</h4>
                    <p>No template files found.</p>
                </div>
            [% END %]
        </div>
        
        <!-- Markdown Documents Tab -->
        <div class="admin-grid file-type-content" id="markdown-docs" style="display: none;">
            [% markdown_pages = [] %]
            [% FOREACH page_name IN categories.general.pages %]
                [% IF structured_pages.$page_name && structured_pages.$page_name.file_type == 'markdown' %]
                    [% markdown_pages.push({ name => page_name, title => structured_pages.$page_name.title }) %]
                [% END %]
            [% END %]
            
            [% markdown_pages = markdown_pages.nsort('title') %]
            [% IF markdown_pages.size > 0 %]
                [% FOREACH page_info IN markdown_pages %]
                    [% page_name = page_info.name %]
                    [% page = structured_pages.$page_name %]
                    <div class="admin-card">
                        <h4><i class="fas fa-file-alt"></i>[% page.title %]</h4>
                        <p>[% page.description || 'Markdown documentation file.' %]</p>
                        <span class="file-type-badge markdown">markdown</span>
                        <ul>
                            <li><a href="[% page.url %]">View Markdown</a></li>
                        </ul>
                    </div>
                [% END %]
            [% ELSE %]
                <div class="admin-card">
                    <h4><i class="fas fa-info-circle"></i>No Markdown Files</h4>
                    <p>No markdown files found.</p>
                </div>
            [% END %]
        </div>
        
        <!-- Other Documents Tab -->
        <div class="admin-grid file-type-content" id="other-docs" style="display: none;">
            [% other_pages = [] %]
            [% FOREACH page_name IN categories.general.pages %]
                [% IF structured_pages.$page_name && structured_pages.$page_name.file_type == 'other' %]
                    [% other_pages.push({ name => page_name, title => structured_pages.$page_name.title }) %]
                [% END %]
            [% END %]
            
            [% other_pages = other_pages.nsort('title') %]
            [% IF other_pages.size > 0 %]
                [% FOREACH page_info IN other_pages %]
                    [% page_name = page_info.name %]
                    [% page = structured_pages.$page_name %]
                    <div class="admin-card">
                        <h4><i class="fas fa-file"></i>[% page.title %]</h4>
                        <p>[% page.description || 'Other documentation file.' %]</p>
                        <span class="file-type-badge other">other</span>
                        <ul>
                            <li><a href="[% page.url %]">View File</a></li>
                        </ul>
                    </div>
                [% END %]
            [% ELSE %]
                <div class="admin-card">
                    <h4><i class="fas fa-info-circle"></i>No Other Files</h4>
                    <p>No other files found.</p>
                </div>
            [% END %]
            </div>
        </div>
    </div>
[% END %]

<!-- JavaScript for tab switching -->
<script>
function showFileType(evt, fileTypeId) {
    // Hide all file type content
    var contents = document.getElementsByClassName('file-type-content');
    for (var i = 0; i < contents.length; i++) {
        contents[i].style.display = 'none';
    }
    
    // Remove active class from all buttons and set to secondary
    var buttons = document.querySelectorAll('.feature-actions button');
    for (var i = 0; i < buttons.length; i++) {
        buttons[i].className = buttons[i].className.replace(' active', '').replace('btn-primary', 'btn-secondary');
    }
    
    // Show the selected file type content and mark the button as active
    var fileTypeElement = document.getElementById(fileTypeId);
    if (fileTypeElement) {
        fileTypeElement.style.display = 'grid'; // Use grid for admin-grid
    }
    
    // Set the clicked button as active and primary
    evt.currentTarget.className = evt.currentTarget.className.replace('btn-secondary', 'btn-primary') + ' active';
}
</script>