
[% PageVersion = 'pagetop.tt,v 0.022 2025/02/27 shanta Exp shanta ' %]
[%# PageVersion = 'pagetop.tt,v 0.02 2023/08/30 shanta Exp shanta ' %]

[% IF c.session.debug_mode == 1 %]
<div class="debug">
    [% PageVersion %]
    [% INCLUDE 'debug.tt' %]

</div>
[% END %]

[% IF c.stash.debug_msg.defined && c.stash.debug_msg.size > 0 %]
    <div class="debug-messages" style="background-color: #f8f9fa; border: 1px solid #ddd; padding: 10px; margin-bottom: 15px;">
        <h4>Debug Messages</h4>
        [% FOREACH msg IN c.stash.debug_msg %]
            <p class="debug" style="margin: 2px 0; font-family: monospace;">Debug [% loop.index %]: [% msg %]</p>
        [% END %]
    </div>
[% END %]


[% SET roles = c.session.roles || [] %]

<header>
    <h1>
        Welcome [% IF roles.grep('admin').size %]
[% c.session.first_name %] [% c.session.last_name %] Administrator
[% ELSIF roles.grep('user').size %]
<p> [% c.session.first_name %] [% c.session.last_name %] User
[% ELSE %]
<p> Guest
[% END %] to [% c.stash.ScriptDisplayName %]!
    </h1>






    <!-- Main Menu -->
    <nav>
        <ul class="horizontal-menu">
            <li class="horizontal-dropdown">
                <a href="[% c.session.return_url %]" class="dropbtn">Back</a>
            </li>
        [% INCLUDE 'Navigation/TopDropListMain.tt' %]
        [% INCLUDE 'Navigation/TopDropListLogin.tt' %]
        [% INCLUDE 'Navigation/TopDropListGlobal.tt' %]
        [% INCLUDE 'Navigation/TopDropListHosted.tt' %]
        [% INCLUDE 'Navigation/TopDropListMember.tt' %]

        [% SET is_admin = c.session.roles.grep('admin').size > 0 %]

        [% IF is_admin %]
            [% INCLUDE 'Navigation/admintopmenu.tt' %]
        [% END %]

        [% INCLUDE 'Navigation/TopDropListHelpDesk.tt' %]
        </ul>
    </nav>
</header>
[% IF error_msg %]<div class="alert error">[% error_msg %]</div>[% END %]
[% IF success_msg %]<div class="alert success">[% success_msg %]</div>[% END %]
[% IF error_msg %]
<p class="error">Error: [% error_msg %]</p>
[% END %]

[% IF success_msg %]
<p class="success">Success: [% success_msg %]</p>
[% END %]
    [% IF c.stash.success_msg %]
        [% FOREACH msg IN c.stash.success_msg %]
        <p class="debug">Debug: [% msg %]</p>
        [% END %]
    [% END %]

[% IF c.session.roles && c.session.roles.size %]
    [% FOREACH role IN c.session.roles %]
        [% IF role == 'admin' %]
            [% SET is_admin = 1 %]
        [% END %]
    [% END %]
[% END %]